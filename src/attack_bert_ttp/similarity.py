import numpy as np

def cosine_similarity(a: np.ndarray, b: np.ndarray) -> float:
    """
    Cosine similarity for two 1D vectors. Return float in [-1, 1].
    """
    # TODO: implement numerically stable cosine similarity
    raise NotImplementedError
